<mujoco model="dexRL">
  <compiler angle="radian" meshdir="dex_for_urdf/urdf/" autolimits="true"/>
  
  <option timestep="0.002" gravity="0 0 -9.81" iterations="50" solver="PGS">
    <flag contact="enable" energy="enable"/>
  </option>

  <asset>
    <mesh name="base_link" file="base_link.STL"/>
    <mesh name="thumb_proximal_link" file="thumb_proximal_link.STL"/>
    <mesh name="thumb_middle_link" file="thumb_middle_link.STL"/>
    <mesh name="thumb_distal_link" file="thumb_distal_link.STL"/>
    <mesh name="pointer_proximal_link" file="pointer_proximal_link.STL"/>
    <mesh name="pointer_middle_link" file="pointer_middle_link.STL"/>
    <mesh name="pointer_distal_link" file="pointer_distal_link.STL"/>
    <mesh name="middle_proximal_link" file="middle_proximal_link.STL"/>
    <mesh name="middle_middle_link" file="middle_middle_link.STL"/>
    <mesh name="middle_distal_link" file="middle_distal_link.STL"/>
    <mesh name="ring_proximal_link" file="ring_proximal_link.STL"/>
    <mesh name="ring_middle_link" file="ring_middle_link.STL"/>
    <mesh name="ring_distal_link" file="ring_distal_link.STL"/>
    <mesh name="pinky_proximal_link" file="pinky_proximal_link.STL"/>
    <mesh name="pinky_middle_link" file="pinky_middle_link.STL"/>
    <mesh name="pinky_distal_link" file="pinky_distal_link.STL"/>
  </asset>

  <default>
    <geom friction="1 0.005 0.0001" condim="3" margin="0.001" solimp="0.9 0.95 0.001" solref="0.02 1"/>
    <joint limited="true" damping="0.5" armature="0.01"/>
    
    <default class="proxjt"><joint range="0 1.57"/></default>
    <default class="midjt"><joint range="0 1.57"/></default>
    <default class="distjt"><joint range="0 1.57"/></default>
    <default class="thumbjt"><joint range="-0.5 1.0"/></default> 
    <default class="hand_actuator">
      <position ctrlrange="0 1.57" kp="30" kv="2" forcerange="-2 2"/>
    </default>
  </default>

  <worldbody>
    <light diffuse=".5 .5 .5" pos="0 0 3" dir="0 0 -1"/>
    <geom name="floor" type="plane" size="1 1 0.1" rgba=".2 .3 .4 1"/>

    <body name="object" pos="0.65 -1.1 0.95">
      <joint name="object_joint" type="free"/> 
      <inertial pos="0 0 0" mass="0.05" diaginertia="1e-4 1e-4 1e-4"/>
      <geom name="object_geom" type="sphere" size="0.03" rgba="1 0 0 1" friction="1.5 0.1 0.1"/>
    </body>

    <body name="goal" pos="0.65 -1.1 1.2" mocap="true">
      <geom name="goal_geom" type="sphere" size="0.03" rgba="0 1 0 0.3" contype="0" conaffinity="0"/>
    </body>

    <body name="base" pos="0.65 -1.3 1.0" mocap="true">
      <geom type="mesh" mesh="base_link" rgba="0.79 0.82 0.93 1"/>

      <body name="thumb_proximal" pos="0.664 -1.27 0.814" quat="0.67 0.67 0.22 0.22">
        <joint name="proxthumbjt" class="thumbjt" axis="0 1 0"/>
        <geom type="mesh" mesh="thumb_proximal_link" rgba="0.79 0.82 0.93 1"/>
        <body name="thumb_middle" pos="0.014 0.046 0.058" quat="0.54 -0.37 0.69 -0.28">
          <joint name="midthumbjt" class="midjt" axis="0 0 1"/>
          <geom type="mesh" mesh="thumb_middle_link" rgba="0.79 0.82 0.93 1"/>
          <body name="thumb_distal" pos="-0.031 0.004 0" quat="-0.49 -0.46 0.63 -0.36">
            <joint name="distalthumbjt" class="distjt" axis="0.96 0 -0.24"/>
            <geom type="mesh" mesh="thumb_distal_link" rgba="0.79 0.82 0.93 1"/>
            <site name="thumb_tip" pos="0 0.02 0" size="0.005"/> 
          </body>
        </body>
      </body>

      <body name="pointer_proximal" pos="0.665 -1.279 0.898" quat="0.04 -0.7 -0.04 0.7">
        <joint name="proxpointerjt" class="proxjt" axis="0 0 1"/>
        <geom type="mesh" mesh="pointer_proximal_link" rgba="0.79 0.82 0.93 1"/>
        <body name="pointer_middle" pos="-0.043 0 -0.0002" quat="0 0.04 0.99 0">
          <joint name="midpointerjt" class="midjt" axis="0 0 1"/>
          <geom type="mesh" mesh="pointer_middle_link" rgba="0.79 0.82 0.93 1"/>
          <body name="pointer_distal" pos="0.026 0 0.0002" quat="0 0.73 0.68 0">
            <joint name="distalpointerjt" class="distjt" axis="0 0 1"/>
            <geom type="mesh" mesh="pointer_distal_link" rgba="0.79 0.82 0.93 1"/>
            <site name="pointer_tip" pos="0 0.02 0" size="0.005"/>
          </body>
        </body>
      </body>

      <body name="middle_proximal" pos="0.647 -1.279 0.898" quat="0.04 -0.7 -0.04 0.7">
        <joint name="proxmiddlejt" class="proxjt" axis="0 0 1"/>
        <geom type="mesh" mesh="middle_proximal_link" rgba="0.79 0.82 0.93 1"/>
        <body name="middle_middle" pos="-0.043 0 -0.0002" quat="0 0.04 0.99 0">
          <joint name="midmiddlejt" class="midjt" axis="0 0 1"/>
          <geom type="mesh" mesh="middle_middle_link" rgba="0.79 0.82 0.93 1"/>
          <body name="middle_distal" pos="0.026 0 0.0002" quat="0 0.73 0.68 0">
            <joint name="distalmiddlejt" class="distjt" axis="0 0 1"/>
            <geom type="mesh" mesh="middle_distal_link" rgba="0.79 0.82 0.93 1"/>
            <site name="middle_tip" pos="0 0.02 0" size="0.005"/>
          </body>
        </body>
      </body>

      <body name="ring_proximal" pos="0.627 -1.279 0.898" quat="0.04 -0.7 -0.04 0.7">
        <joint name="proxringjt" class="proxjt" axis="0 0 1"/>
        <geom type="mesh" mesh="ring_proximal_link" rgba="0.79 0.82 0.93 1"/>
        <body name="ring_middle" pos="-0.043 0 -0.0002" quat="0 0.04 0.99 0">
          <joint name="midringjt" class="midjt" axis="0 0 1"/>
          <geom type="mesh" mesh="ring_middle_link" rgba="0.79 0.82 0.93 1"/>
          <body name="ring_distal" pos="0.026 0 0.0002" quat="0 0.73 0.68 0">
            <joint name="distalringjt" class="distjt" axis="0 0 1"/>
            <geom type="mesh" mesh="ring_distal_link" rgba="0.79 0.82 0.93 1"/>
            <site name="ring_tip" pos="0 0.02 0" size="0.005"/>
          </body>
        </body>
      </body>

      <body name="pinky_proximal" pos="0.609 -1.279 0.898" quat="0.04 -0.7 -0.04 0.7">
        <joint name="proxpinkyjt" class="proxjt" axis="0 0 1"/>
        <geom type="mesh" mesh="pinky_proximal_link" rgba="0.79 0.82 0.93 1"/>
        <body name="pinky_middle" pos="-0.043 0 -0.0002" quat="0 0.04 0.99 0">
          <joint name="midpinkyjt" class="midjt" axis="0 0 1"/>
          <geom type="mesh" mesh="pinky_middle_link" rgba="0.79 0.82 0.93 1"/>
          <body name="pinky_distal" pos="0.026 0 0.0002" quat="0 0.73 0.68 0">
            <joint name="distalpinkyjt" class="distjt" axis="0 0 1"/>
            <geom type="mesh" mesh="pinky_distal_link" rgba="0.79 0.82 0.93 1"/>
            <site name="pinky_tip" pos="0 0.02 0" size="0.005"/>
          </body>
        </body>
      </body>
    </body>
  </worldbody>

  <actuator>
    <position name="act_proxthumb"  joint="proxthumbjt"   class="hand_actuator"/>
    <position name="act_midthumb"   joint="midthumbjt"    class="hand_actuator" gear = "-1"/>
    <position name="act_distthumb"  joint="distalthumbjt" class="hand_actuator"/>
    
    <position name="act_proxpoint"  joint="proxpointerjt" class="hand_actuator"  gear = "-1"/>
    <position name="act_midpoint"   joint="midpointerjt"  class="hand_actuator"/>
    <position name="act_distpoint"  joint="distalpointerjt" class="hand_actuator"  gear = "-1"/>
    
    <position name="act_proxmid"    joint="proxmiddlejt"  class="hand_actuator"  gear = "-1"/>
    <position name="act_midmid"     joint="midmiddlejt"   class="hand_actuator"/>
    <position name="act_distmid"    joint="distalmiddlejt" class="hand_actuator"  gear = "-1"/>
    
    <position name="act_proxring"   joint="proxringjt"    class="hand_actuator" gear = "-1"/>
    <position name="act_midring"    joint="midringjt"     class="hand_actuator"/>
    <position name="act_distring"   joint="distalringjt"  class="hand_actuator" gear = "-1"/>
    
    <position name="act_proxpinky"  joint="proxpinkyjt"   class="hand_actuator" gear = "-1"/>
    <position name="act_midpinky"   joint="midpinkyjt"    class="hand_actuator"/>
    <position name="act_distpinky"  joint="distalpinkyjt" class="hand_actuator" gear = "-1"/>
  </actuator>

  <sensor>
    <touch name="thumb_touch"  site="thumb_tip"/>
    <touch name="point_touch"  site="pointer_tip"/>
    <touch name="mid_touch"    site="middle_tip"/>
    <touch name="ring_touch"   site="ring_tip"/>
    <touch name="pinky_touch"  site="pinky_tip"/>
  </sensor>

  <equality>
    <joint joint1="proxpointerjt" joint2="midpointerjt" polycoef="2.95681 -2.03714 0.862539 -0.296976"/>
    <joint joint1="proxpointerjt" joint2="distalpointerjt" polycoef="3.05708 -0.909854 0.306121 -0.122724"/>

    <joint joint1="proxmiddlejt" joint2="midmiddlejt" polycoef="2.95681 -2.03714 0.862539 -0.296976"/>
    <joint joint1="proxmiddlejt" joint2="distalmiddlejt" polycoef="3.05708 -0.909854 0.306121 -0.122724"/>
    
    <joint joint1="proxringjt"    joint2="midringjt"    polycoef="2.95681 -2.03714 0.862539 -0.296976"/>
    <joint joint1="proxringjt"    joint2="distalringjt" polycoef="3.05708 -0.909854 0.306121 -0.122724"/>
    
    <joint joint1="proxpinkyjt"   joint2="midpinkyjt"   polycoef="2.95681 -2.03714 0.862539 -0.296976"/>
    <joint joint1="proxpinkyjt"   joint2="distalpinkyjt" polycoef="3.05708 -0.909854 0.306121 -0.122724"/>
  </equality>
</mujoco>